<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Constellation Builder - Connect Your Ideas</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header>
            <div class="logo">
                <span class="star-icon">‚ú®</span>
                <h1>Constellation Builder</h1>
            </div>
            <div class="actions">
                <div class="zoom-controls">
                    <button id="zoomOutBtn" class="btn secondary zoom-btn">‚ûñ</button>
                    <span id="zoomLevel">100%</span>
                    <button id="zoomInBtn" class="btn secondary zoom-btn">‚ûï</button>
                </div>
            </div>
            <div class="actions mobile-actions">
                <button id="statsBtn" class="btn secondary">üìä Stats</button>
                <button id="importBtn" class="btn secondary">üì§ Import</button>
                <button id="themeToggleBtn" class="btn secondary">üåó Theme</button>
                <button id="resetViewBtn" class="btn secondary">üìê Reset</button>
                <button id="searchBtn" class="btn secondary">üîç</button>
                <button id="connectByTagBtn" class="btn secondary">üîóüè∑Ô∏è</button>
                <button id="filterTagsBtn" class="btn secondary">üè∑Ô∏è Filter</button>
                <button id="templatesBtn" class="btn secondary">üìö Templates</button>
                <button id="exportBtn" class="btn secondary">üì•</button>
                <button id="shareBtn" class="btn secondary">üîó</button>
                <button id="layoutBtn" class="btn secondary">üìê Layout</button>
                <button id="clearBtn" class="btn secondary">üóëÔ∏è</button>
                <button id="helpBtn" class="btn secondary">‚ùì</button>
            </div>
        </header>

        <!-- Main Canvas Area -->
        <main>
            <div class="canvas-container">
                <canvas id="constellationCanvas"></canvas>
                <div id="canvasOverlay"></div>
                <div class="minimap-container">
                    <canvas id="minimap" class="minimap"></canvas>
                </div>
            </div>

            <!-- Toolbar -->
            <div class="toolbar">
                <div class="tool-group">
                    <span class="tool-label">Mode:</span>
                    <button class="tool-btn active" data-mode="add" title="Click to add a star (idea)">
                        <span class="icon">‚ûï</span>
                        <span class="text">Add Star</span>
                    </button>
                    <button class="tool-btn" data-mode="connect" title="Drag to connect stars">
                        <span class="icon">üîó</span>
                        <span class="text">Connect</span>
                    </button>
                    <button class="tool-btn" data-mode="move" title="Drag to move stars">
                        <span class="icon">‚úã</span>
                        <span class="text">Move</span>
                    </button>
                    <button class="tool-btn" data-mode="delete" title="Click to delete">
                        <span class="icon">‚ùå</span>
                        <span class="text">Delete</span>
                    </button>
                    <button class="tool-btn" data-mode="select" title="Click to select multiple">
                        <span class="icon">‚úÖ</span>
                        <span class="text">Select</span>
                    </button>
                </div>

                <div class="tool-group">
                    <span class="tool-label">Color:</span>
                    <div class="color-picker">
                        <button class="color-btn active" data-color="#ffffff" style="background: #ffffff; box-shadow: 0 0 10px #ffffff;"></button>
                        <button class="color-btn" data-color="#ffd700" style="background: #ffd700; box-shadow: 0 0 10px #ffd700;"></button>
                        <button class="color-btn" data-color="#00bfff" style="background: #00bfff; box-shadow: 0 0 10px #00bfff;"></button>
                        <button class="color-btn" data-color="#ff6b6b" style="background: #ff6b6b; box-shadow: 0 0 10px #ff6b6b;"></button>
                        <button class="color-btn" data-color="#98fb98" style="background: #98fb98; box-shadow: 0 0 10px #98fb98;"></button>
                        <button class="color-btn" data-color="#dda0dd" style="background: #dda0dd; box-shadow: 0 0 10px #dda0dd;"></button>
                    </div>
                </div>

                <div class="tool-group">
                    <span class="tool-label">Line Style:</span>
                    <div class="line-style-picker">
                        <button class="line-style-btn active" data-style="solid" title="Solid line">
                            <span class="line-icon">‚îÅ‚îÅ</span>
                            <span class="line-text">Solid</span>
                        </button>
                        <button class="line-style-btn" data-style="dashed" title="Dashed line">
                            <span class="line-icon">‚îÑ‚îÑ</span>
                            <span class="line-text">Dashed</span>
                        </button>
                        <button class="line-style-btn" data-style="dotted" title="Dotted line">
                            <span class="line-icon">¬∑¬∑¬∑</span>
                            <span class="line-text">Dotted</span>
                        </button>
                    </div>

                <div class="tool-group">
                    <span class="tool-label">Batch Actions:</span>
                    <button id="batchDeleteBtn" class="btn secondary" title="Delete selected stars" disabled>üóëÔ∏è Delete Selected</button>
                    <button id="batchColorBtn" class="btn secondary" title="Change color of selected stars" disabled>üé® Change Color</button>
                </div>
            </div>
        </main>

        <!-- Star Editor Modal -->
        <div id="starModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚ú® Edit Star</h2>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="starTitle">Title</label>
                        <input type="text" id="starTitle" placeholder="e.g., Project Alpha">
                    </div>
                    <div class="form-group">
                        <label for="starDescription">Description / Notes</label>
                        <textarea id="starDescription" rows="4" placeholder="Describe your idea in detail... Use multi-line for detailed notes" style="resize: vertical; min-height: 80px;"></textarea>
                        <div class="char-count" id="descriptionCharCount" style="color: var(--text-secondary); font-size: 12px; text-align: right; margin-top: 4px;">0 characters</div>
                    </div>
                    <div class="form-group">
                        <label for="starShape">Shape</label>
                        <select id="starShape" style="width: 100%; padding: 12px; background: rgba(0,0,0,0.3); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary);">
                            <option value="circle">‚≠ï Circle</option>
                            <option value="diamond">üíé Diamond</option>
                            <option value="hexagon">‚¨° Hexagon</option>
                            <option value="star">‚≠ê Star</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="starTags">Tags (comma separated)</label>
                        <input type="text" id="starTags" placeholder="e.g., idea, project, urgent">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" id="cancelStar">Cancel</button>
                    <button class="btn primary" id="saveStar">Save Star</button>
                </div>
            </div>
        </div>

        <!-- Search Modal -->
        <div id="searchModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üîç Search Constellation</h2>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <input type="text" id="searchInput" placeholder="Search by title or tag..." autofocus>
                    </div>
                    <div class="form-group">
                        <button class="btn primary" id="searchBtnAction" style="width: 100%;">Search</button>
                    </div>
                    <div id="searchResults" style="margin-top: 20px;"></div>
                </div>
            </div>
        </div>

        <!-- Help Modal -->
        <div id="helpModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚ùì How to Use Constellation Builder</h2>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="help-section">
                        <h3>üåü Adding Stars</h3>
                        <p>Select "Add Star" mode and click anywhere on the canvas to create a new star. Stars represent your ideas, thoughts, or concepts.</p>
                    </div>
                    <div class="help-section">
                        <h3>üîó Connecting Stars</h3>
                        <p>Select "Connect" mode and drag from one star to another to create a glowing connection. Use colors to show different types of relationships.</p>
                    </div>
                    <div class="help-section">
                        <h3>‚úã Moving Stars</h3>
                        <p>Select "Move" mode and drag stars to rearrange your constellation. All connections will move with them.</p>
                    </div>
                    <div class="help-section">
                        <h3>‚ú® Editing Stars</h3>
                        <p>Double-click any star to edit its title, description, and tags. This helps you organize and remember your ideas.</p>
                    </div>
                    <div class="help-section">
                        <h3>üì• Exporting</h3>
                        <p>Click "Export" to save your constellation as a PNG image or JSON backup. Your work is also automatically saved in your browser.</p>
                    </div>
                    <div class="help-section">
                        <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
                        <p>
                            <strong>Space</strong> - Add random star (fun!)<br>
                            <strong>Ctrl+Z</strong> - Undo<br>
                            <strong>Ctrl+Y</strong> - Redo<br>
                            <strong>Ctrl+F</strong> - Search<br>
                            <strong>Escape</strong> - Close modals
                        </p>
                    </div>
                    <div class="help-section">
                        <h3>üìê Zoom & Pan</h3>
                        <p>
                            <strong>Mouse wheel</strong> - Zoom in/out<br>
                            <strong>Shift + Drag</strong> - Pan around the canvas<br>
                            <strong>Reset View</strong> - Return to default zoom and position
                        </p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn primary" id="closeHelp">Got it!</button>
                </div>
            </div>
        </div>

        <!-- Export Modal -->
        <div id="exportModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üì• Export Constellation</h2>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="export-options">
                        <button class="export-option" data-format="png">
                            <span class="export-icon">üñºÔ∏è</span>
                            <span class="export-label">PNG Image</span>
                            <span class="export-desc">Shareable image of your constellation</span>
                        </button>
                        <button class="export-option" data-format="svg">
                            <span class="export-icon">üìê</span>
                            <span class="export-label">SVG Vector</span>
                            <span class="export-desc">Scalable vector for professional use</span>
                        </button>
                        <button class="export-option" data-format="json">
                            <span class="export-icon">üìÑ</span>
                            <span class="export-label">JSON Backup</span>
                            <span class="export-desc">Full data backup with all details</span>
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" id="cancelExport">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Import Modal -->
        <div id="importModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üì§ Import Constellation</h2>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="importFile">Select JSON file</label>
                        <input type="file" id="importFile" accept=".json">
                    </div>
                    <div class="form-group">
                        <label>Import Options</label>
                        <select id="importMode" style="width: 100%; padding: 12px; background: rgba(0,0,0,0.3); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary);">
                            <option value="append">Append to current (merge)</option>
                            <option value="replace">Replace all (new constellation)</option>
                        </select>
                    </div>
                    <p style="color: #ffd700; font-size: 13px;">üí° Tip: Export your work first if you want to keep both versions!</p>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" id="cancelImport">Cancel</button>
                    <button class="btn primary" id="confirmImport">Import</button>
                </div>
            </div>
        </div>

        <!-- Share Modal -->
        <div id="shareModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üîó Share Constellation</h2>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom: 16px; color: var(--text-secondary);">Share your constellation via link. Anyone with the link can view and edit a copy.</p>
                    <div class="form-group">
                        <label>Shareable Link</label>
                        <div style="display: flex; gap: 8px;">
                            <input type="text" id="shareLink" readonly style="flex: 1; padding: 12px; background: rgba(0,0,0,0.3); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-size: 13px;">
                            <button class="btn primary" id="copyShareLink">üìã Copy</button>
                        </div>
                    </div>
                    <p id="shareWarning" class="hidden" style="color: #ff9800; font-size: 13px; margin-top: 8px;">‚ö†Ô∏è This constellation is large. Consider using JSON export for reliable sharing.</p>
                    <p id="shareSuccess" class="hidden" style="color: #4caf50; font-size: 13px; margin-top: 8px;">‚úÖ Link copied to clipboard!</p>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" id="cancelShare">Close</button>
                </div>
            </div>
        </div>

        <!-- Statistics Modal -->
        <div id="statsModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìä Constellation Statistics</h2>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Total Stars</div>
                            <div class="stat-value" id="statTotalStars">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Total Connections</div>
                            <div class="stat-value" id="statTotalConnections">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Avg Connections/Star</div>
                            <div class="stat-value" id="statAvgConnections">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Most Connected</div>
                            <div class="stat-value" id="statMostConnected">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Total Tags</div>
                            <div class="stat-value" id="statTotalTags">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Most Used Tag</div>
                            <div class="stat-value" id="statMostUsedTag">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Oldest Star</div>
                            <div class="stat-value" id="statOldestStar">-</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Newest Star</div>
                            <div class="stat-value" id="statNewestStar">-</div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn primary" id="closeStats">Close</button>
                </div>
            </div>
        </div>

        <!-- Tag Filter Modal -->
        <div id="tagFilterModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üè∑Ô∏è Filter by Tags</h2>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">
                            Click tags to toggle visibility. Stars with hidden tags will become transparent.
                        </p>
                    </div>
                    <div id="tagFilterList" style="display: flex; flex-wrap: wrap; gap: 10px;">
                        <!-- Tags will be populated here dynamically -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" id="showAllTags">Show All</button>
                    <button class="btn primary" id="closeTagFilter">Close</button>
                </div>
            </div>
        </div>

        <!-- Templates Modal -->
        <div id="templatesModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìö Constellation Templates</h2>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="template-options">
                        <button class="template-option" data-template="mindmap">
                            <span class="template-icon">üß†</span>
                            <span class="template-label">Mind Map</span>
                            <span class="template-desc">Central idea with radiating branches</span>
                        </button>
                        <button class="template-option" data-template="orgchart">
                            <span class="template-icon">üë•</span>
                            <span class="template-label">Org Chart</span>
                            <span class="template-desc">Hierarchical structure</span>
                        </button>
                        <button class="template-option" data-template="flowchart">
                            <span class="template-icon">üìä</span>
                            <span class="template-label">Flowchart</span>
                            <span class="template-desc">Process flow visualization</span>
                        </button>
                        <button class="template-option" data-template="project">
                            <span class="template-icon">üéØ</span>
                            <span class="template-label">Project Map</span>
                            <span class="template-desc">Goal-oriented layout</span>
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" id="cancelTemplates">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Layout Modal -->
        <div id="layoutModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìê Auto Layout</h2>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="template-options">
                        <button class="template-option" data-layout="force">
                            <span class="template-icon">‚ö°</span>
                            <span class="template-label">Force-Directed</span>
                            <span class="template-desc">Spread stars naturally with physics simulation</span>
                        </button>
                        <button class="template-option" data-layout="circle">
                            <span class="template-icon">‚≠ï</span>
                            <span class="template-label">Circle</span>
                            <span class="template-desc">Arrange stars in a circular pattern</span>
                        </button>
                        <button class="template-option" data-layout="grid">
                            <span class="template-icon">‚äû</span>
                            <span class="template-label">Grid</span>
                            <span class="template-desc">Organize stars in a regular grid</span>
                        </button>
                        <button class="template-option" data-layout="radial">
                            <span class="template-icon">üéØ</span>
                            <span class="template-label">Radial</span>
                            <span class="template-desc">Center star with connected stars radiating outward</span>
                        </button>
                    </div>
                    <div class="form-group" style="margin-top: 20px;">
                        <label for="layoutPadding">Padding (px):</label>
                        <input type="range" id="layoutPadding" min="50" max="200" value="100">
                        <span id="layoutPaddingValue">100</span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" id="cancelLayout">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
